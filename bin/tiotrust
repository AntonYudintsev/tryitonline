#!/usr/bin/env bash

set -o errexit -o nounset -o pipefail -o xtrace

getent hosts "$@" | while read ip hostname; do
	mkdir --parents ~/.ssh
	chmod 700 ~/.ssh
	touch ~/.ssh/known_hosts
	chmod 600 ~/.ssh/known_hosts
	ssh-keygen -R "$hostname"
	ssh-keygen -R "$ip"
	ssh-keyscan -t ecdsa-sha2-nistp256 "$hostname" "$ip" >> ~/.ssh/known_hosts
done
